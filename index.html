<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Estimate parameters of the hysteretic threshold autoregressive
    (HysTAR) model, using conditional least squares.
    In addition, you can generate time series data from the HysTAR model.
    For details, see Li, Guan, Li and Yu (2015) &lt;doi:10.1093/biomet/asv017&gt;.">
<title>Fit the Hysteretic Threshold Autoregressive Model â€¢ hystar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fit the Hysteretic Threshold Autoregressive Model">
<meta property="og:description" content="Estimate parameters of the hysteretic threshold autoregressive
    (HysTAR) model, using conditional least squares.
    In addition, you can generate time series data from the HysTAR model.
    For details, see Li, Guan, Li and Yu (2015) &lt;doi:10.1093/biomet/asv017&gt;.">
<meta property="og:image" content="https://daandejongen.github.io/hystar/, https://dplyr.tidyverse.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">hystar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/hystar.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/daandejongen/hystar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="hystar-">hystar 
<a class="anchor" aria-label="anchor" href="#hystar-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The R-package <a href="https://cran.r-project.org/package=hystar" class="external-link"><code>hystar</code></a> package allows you to simulate and estimate the hysteretic threshold autoregressive (HysTAR) model. It comes with three functions:</p>
<ul>
<li><p><code>hystar_fit</code>, to estimate the HysTAR parameters with the conditional least squares method,</p></li>
<li><p><code>z_sim</code>, to simulate a threshold variable,</p></li>
<li><p><code>hystar_sim</code>, to simulate an outcome variable</p></li>
</ul>
<p>Results from the time series analysis can be assessed with the standard methods in R, like <code>plot</code>, <code>summary</code> and <code>print</code>. Additionally, you can extract the predictive residuals with the <code>residuals</code>-method for further analysis.</p>
</div>
<div class="section level2">
<h2 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h2>
<p>A minimal example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/daandejongen/hystar/" class="external-link">hystar</a></span><span class="op">)</span></span>
<span><span class="va">control_variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/z_sim.html">z_sim</a></span><span class="op">(</span>n_t <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">simulated_hystar_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hystar_sim.html">hystar_sim</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">control_variable</span><span class="op">)</span></span>
<span><span class="va">fitted_hystar_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hystar_fit.html">hystar_fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simulated_hystar_model</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitted_hystar_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; HysTAR model fitted on 99 observations, of which</span></span>
<span><span class="co">#&gt; 50 observations in regime 0 and</span></span>
<span><span class="co">#&gt; 49 observations in regime 1.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated thresholds:</span></span>
<span><span class="co">#&gt;     r0     r1 </span></span>
<span><span class="co">#&gt; -0.509  0.562 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated delay:</span></span>
<span><span class="co">#&gt; 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated model coefficients:</span></span>
<span><span class="co">#&gt;          est    SE     p</span></span>
<span><span class="co">#&gt; phi_00 0.068 0.142 0.634</span></span>
<span><span class="co">#&gt; phi_01 0.553 0.093 0.000</span></span>
<span><span class="co">#&gt; phi_10 3.038 0.535 0.000</span></span>
<span><span class="co">#&gt; phi_11 0.256 0.131 0.051</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated residual variances:</span></span>
<span><span class="co">#&gt; sigma2_0 sigma2_1 </span></span>
<span><span class="co">#&gt;    0.955    0.857 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals: </span></span>
<span><span class="co">#&gt;    min     1q median     3q    max </span></span>
<span><span class="co">#&gt; -2.379 -0.645  0.005  0.580  2.655 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Information criteria:</span></span>
<span><span class="co">#&gt;       aic      aicc       bic </span></span>
<span><span class="co">#&gt;  2.104235  3.159307 13.515765</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h2>
<p>For the current <a href="https://cran.r-project.org/package=hystar" class="external-link">CRAN release</a> (1.0.0):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"hystar"</span>)</span></code></pre></div>
<p>For the development version (1.2.0.9000):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"daandejongen/hystar"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cite">Cite<a class="anchor" aria-label="anchor" href="#cite"></a>
</h2>
<p>If you have used this package for an scientific publication, please cite it with:</p>
<p>De Jong, D. (2022). <em>hystar: Simulation and Estimation of the Hysteretic TAR Model</em>. R package version 1.2.0, <a href="https://github.com/daandejongen/hystar/" class="external-link uri">https://github.com/daandejongen/hystar/</a>.</p>
<p>BibTeX:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>Manual{,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">=</span> {hystar<span class="sc">:</span> Simulation and Estimation of the Hysteretic TAR Model},</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    author <span class="ot">=</span> {Daan {de Jong}},</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    year <span class="ot">=</span> {<span class="dv">2022</span>},</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    note <span class="ot">=</span> {R package version <span class="dv">1</span>.<span class="fl">2.0</span>},</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    url <span class="ot">=</span> {https<span class="sc">:</span><span class="er">//</span>github.com<span class="sc">/</span>daandejongen<span class="sc">/</span>hystar<span class="sc">/</span>},</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-more-info">Get more info<a class="anchor" aria-label="anchor" href="#get-more-info"></a>
</h2>
<p>For more information, see the <a href="https://daandejongen.github.io/hystar/" class="external-link"><code>hystar</code> website</a>.</p>
<p>If you want to read more, see the paper with the original proposal of the HysTAR model in Biometrika (<a href="https://academic.oup.com/biomet/article-abstract/102/3/717/2365298?login=false" class="external-link">Li, Guan, Li and Yu (2015)</a>).</p>
<p>If you need something more accessible, I am working on a paper about using the HysTAR model in psychological research. There, I also explain in more detail what hysteresis is.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=hystar" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/daandejongen/hystar/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/daandejongen/hystar/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing hystar</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Daan de Jong <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-6034-0136" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>European Research Council <br><small class="roles"> Funder </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-green.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/daandejongen/hystar/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/daandejongen/hystar/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daan de Jong, European Research Council.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
